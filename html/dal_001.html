<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="authoring-tool" content="Adobe_Animate_CC" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>dal_001</title>

  <!-- Webfonter -->
  <link rel="preload" href="https://thechineseroom.github.io/banner_assets/fonts/CircularXXWeb-Black.woff2?v=1" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="https://thechineseroom.github.io/banner_assets/fonts/CircularXXWeb-Medium.woff2?v=1" as="font" type="font/woff2" crossorigin>
  <style>
    @font-face {
      font-family: 'CircularXX Black';
      src: url('https://thechineseroom.github.io/banner_assets/fonts/CircularXXWeb-Black.woff2?v=1') format('woff2'),
           url('https://thechineseroom.github.io/banner_assets/fonts/CircularXXWeb-Black.woff?v=1') format('woff');
      font-weight: 900; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'CircularXX Medium';
      src: url('https://thechineseroom.github.io/banner_assets/fonts/CircularXXWeb-Medium.woff2?v=1') format('woff2'),
           url('https://thechineseroom.github.io/banner_assets/fonts/CircularXXWeb-Medium.woff?v=1') format('woff');
      font-weight: 500; font-style: normal; font-display: swap;
    }

    html, body { height: 100%; margin: 0; background: #fff; }
    /* Ytter-wrapper som definierar den yta bannern får */
    #stagewrap {
      position: relative;
      width: 100%;
      height: 100vh;      /* fyll viewport – ändra till valfri höjd om den ska bäddas in */
      overflow: hidden;
      background: #ffffff;
    }
    /* Dessa tre positioneras absolut inne i stagewrap */
    #animation_container, #dom_overlay_container, canvas {
      position: absolute; left: 0; top: 0;
      image-rendering: auto;
    }
  </style>

  <!-- CreateJS + Animate-export -->
  <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
  <script src="dal_001.js"></script>
</head>

<body>
  <div id="stagewrap">
    <div id="animation_container">
      <!-- Behåll din design size här -->
      <canvas id="canvas" width="1920" height="1080" style="display:block; background:#ffffff;"></canvas>
      <div id="dom_overlay_container"></div>
    </div>
  </div>

  <script>
    var canvas, stage, exportRoot, anim_container, dom_overlay_container, fnStartAnimation;

    function init() {
      canvas = document.getElementById("canvas");
      anim_container = document.getElementById("animation_container");
      dom_overlay_container = document.getElementById("dom_overlay_container");
      var comp = AdobeAn.getComposition("E70EBF7283014CCAA194A267093E2191");
      handleComplete({}, comp);
    }

    function handleComplete(evt, comp) {
      var lib = comp.getLibrary();
      exportRoot = new lib.dal_001();
      stage = new lib.Stage(canvas);

      fnStartAnimation = function() {
        stage.addChild(exportRoot);
        createjs.Ticker.framerate = lib.properties.fps;
        createjs.Ticker.addEventListener("tick", stage);
        stage.tickOnUpdate = true;
      };

      // --- RESPONSIVE + RETINA (contain som default) -----------------
      var w = lib.properties.width,  h = lib.properties.height; // t.ex. 1920 x 1080
      var fitMode = "contain"; // "contain" eller "cover"
      var wrap = document.getElementById("stagewrap");

      function resizeCanvas() {
        // verklig tillgänglig yta
        var iw = wrap.clientWidth;
        var ih = wrap.clientHeight;

        // DPR (kan ändras när fönster flyttas mellan skärmar/zoomas)
        var pRatio = window.devicePixelRatio || 1;

        var xRatio = iw / w, yRatio = ih / h;
        var sRatio = (fitMode === "cover") ? Math.max(xRatio, yRatio) : Math.min(xRatio, yRatio);

        // CSS-storlek (synlig)
        var cssW = Math.max(1, Math.round(w * sRatio));
        var cssH = Math.max(1, Math.round(h * sRatio));

        // Intern pixelstorlek (krispigt på DPR>1)
        canvas.width  = Math.max(1, Math.round(w * pRatio * sRatio));
        canvas.height = Math.max(1, Math.round(h * pRatio * sRatio));

        // Synliga mått på alla lager
        var cssWpx = cssW + "px", cssHpx = cssH + "px";
        canvas.style.width = anim_container.style.width = dom_overlay_container.style.width = cssWpx;
        canvas.style.height = anim_container.style.height = dom_overlay_container.style.height = cssHpx;

        // Skala scenen
        stage.scaleX = stage.scaleY = pRatio * sRatio;

        // Centrera inom stagewrap
        var offsetX = (iw - cssW) * 0.5;
        var offsetY = (ih - cssH) * 0.5;
        anim_container.style.left = offsetX + "px";
        anim_container.style.top  = offsetY + "px";
        dom_overlay_container.style.left = anim_container.style.left;
        dom_overlay_container.style.top  = anim_container.style.top;

        // Uppdatera en gång för att undvika “halvskalig” första frame
        stage.update();
      }

      // Lyssna på: container-resize + fönster-resize + DPR-skiften
      var ro = new ResizeObserver(resizeCanvas);
      ro.observe(document.getElementById("stagewrap"));
      window.addEventListener("resize", resizeCanvas);
      window.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`).addEventListener("change", resizeCanvas);
      window.addEventListener("orientationchange", resizeCanvas);

      // Kör en gång efter fonts (om möjligt) + en gång direkt
      if (document.fonts && document.fonts.ready) {
        document.fonts.ready.then(() => { resizeCanvas(); });
      }
      resizeCanvas();
      // ---------------------------------------------------------------

      AdobeAn.compositionLoaded(lib.properties.id);
      fnStartAnimation();
    }

    // Kickoff
    window.addEventListener("load", init);
  </script>
</body>
</html>
